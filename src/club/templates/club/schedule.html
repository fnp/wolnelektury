{% extends "base/base.html" %}


{% block titleextra %}Towarzystwo Wolnych Lektur{% endblock %}


{% block body %}
<div class="white-box normal-text">

<h1>Plan płatności</h1>

<div>E-mail: {{ schedule.email }}</div>
<div>Składka: {{ schedule.amount }} zł {{ schedule.plan.get_interval_display }}</div>
<div>Wybrana metoda płatności: {{ schedule.get_payment_method.name }}</div>

{% if schedule.is_active %}
  {% if schedule.plan.is_perpetual %}
    Opłacona na zawsze.
  {% endif %}
  Aktualnie opłacona do: {{ schedule.expires_at }}

  {% if schedule.get_payment_method.is_recurring %}
  <form method='post' action="{% url 'club_cancel' schedule.key %}">
        {% csrf_token %}
        <button type="submit">Anuluj kolejną płatność</button>
  </form>
  {% else %}
  <form method='post' action=''>
	{% csrf_token %}
	<button type="submit">Opłać kolejny okres</button>
  </form>
  {% endif %}


{% else %}
 {% if schedule.is_expired %}
   Członkostwo wygasło.
   <form method='post' action=''>
        {% csrf_token %}
        <button type="submit">Opłać kolejny okres</button>
   </form>


 {% else %}
   Składka nie została jeszcze opłacona.
   {% if schedule.payuorder_set.exists %}
     Czekamy na potwierdzenie płatności.
   {% else %}

     <form method='post' action=''>
        {% csrf_token %}
        <button type="submit">Zapłać składkę</button>
     </form>

   {% endif %}
 {% endif %}
{% endif %}

<hr>



{% if schedule.membership %}
  <p>
  Członek/członkini Towarzystwa nr {{ schedule.membership.id }} ({{ schedule.membership.user }}).
  </p>

  <form method='post' action='{% url "club_membership" %}'>
	  {% csrf_token %}
	  Imię i nazwisko na legitymację: <br>
	  <input name="name" value="{{ schedule.membership.name|default:schedule.membership.user.username }}"><br>
	  <button type="submit">Zapisz</button>
  </form>

{% else %}
<p>
Płatność nie przypisana do członkostwa.<br>
<a href="{% url 'club_claim' schedule.key %}">Przypisz</a>
</p>
{% endif %}




	
<a href="">

</div>

{% endblock %}
